#!/usr/bin/env node
'use strict';var _regenerator=require('babel-runtime/regenerator');var _regenerator2=_interopRequireDefault(_regenerator);var _asyncToGenerator2=require('babel-runtime/helpers/asyncToGenerator');var _asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2);var executorForLayer=function(){var _ref2=(0,_asyncToGenerator3.default)(/*#__PURE__*/_regenerator2.default.mark(function _callee2(){var fileOptions,generator,key,layerElement;return _regenerator2.default.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:fileOptions={};generator=null;_context2.t0=_regenerator2.default.keys(_cli2.default.args);case 3:if((_context2.t1=_context2.t0()).done){_context2.next=18;break;}key=_context2.t1.value;if(!_cli2.default.args.hasOwnProperty(key)){_context2.next=16;break;}layerElement=_cli2.default.args[key];generator=new _Generator2.default(layerElement,options.generate);fileOptions.folder=generator.getLayerFolder();fileOptions.path=generator.getPath();fileOptions.resourceFolder=generator.getResourceFolder();fileOptions.fileName=generator.fileName;fileOptions.ext=generator.ext;fileOptions.layer=generator.layer;_context2.next=16;return creator.generateLayer(fileOptions,templateSelectors('default').criteria);case 16:_context2.next=3;break;case 18:case'end':return _context2.stop();}}},_callee2,this);}));return function executorForLayer(){return _ref2.apply(this,arguments);};}();var executorForResource=function(){var _ref3=(0,_asyncToGenerator3.default)(/*#__PURE__*/_regenerator2.default.mark(function _callee3(){var resourceLayerFolder,fileOptions,layerGenerator,generator,layers,key,layerElement,_key,layer;return _regenerator2.default.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:resourceLayerFolder='';fileOptions={};layerGenerator=null;generator=null;layers=getLayers();_context3.t0=_regenerator2.default.keys(_cli2.default.args);case 6:if((_context3.t1=_context3.t0()).done){_context3.next=31;break;}key=_context3.t1.value;if(!_cli2.default.args.hasOwnProperty(key)){_context3.next=29;break;}layerElement=_cli2.default.args[key];generator=new _Generator2.default(layerElement,options.generate);resourceLayerFolder=generator.getResourceFolder();creator.createLayerFolder(resourceLayerFolder);_context3.t2=_regenerator2.default.keys(layers);case 14:if((_context3.t3=_context3.t2()).done){_context3.next=29;break;}_key=_context3.t3.value;if(!layers.hasOwnProperty(_key)){_context3.next=27;break;}layer=layers[_key];layerGenerator=new _Generator2.default(layerElement,layer);fileOptions.folder=layerGenerator.getLayerFolder(resourceLayerFolder);fileOptions.path=layerGenerator.getPath(fileOptions.folder);fileOptions.fileName=layerGenerator.fileName;fileOptions.ext=layerGenerator.ext;fileOptions.original=layerElement;fileOptions.layer=layerGenerator.layer;_context3.next=27;return creator.generateLayer(fileOptions,templateSelectors('mongorito').criteria);case 27:_context3.next=14;break;case 29:_context3.next=6;break;case 31:case'end':return _context3.stop();}}},_callee3,this);}));return function executorForResource(){return _ref3.apply(this,arguments);};}();var _chalk=require('chalk');var _chalk2=_interopRequireDefault(_chalk);var _cli=require('cli');var _cli2=_interopRequireDefault(_cli);var _figlet=require('figlet');var _figlet2=_interopRequireDefault(_figlet);var _fs=require('fs');var _fs2=_interopRequireDefault(_fs);var _path=require('path');var _path2=_interopRequireDefault(_path);var _lodash=require('lodash');var _lodash2=_interopRequireDefault(_lodash);var _exec=require('exec');var _exec2=_interopRequireDefault(_exec);var _downloadGitRepo=require('download-git-repo');var _downloadGitRepo2=_interopRequireDefault(_downloadGitRepo);var _Generator=require('./core/Generator');var _Generator2=_interopRequireDefault(_Generator);var _Reader=require('./core/Reader');var _Reader2=_interopRequireDefault(_Reader);var _Creator=require('./core/Creator');var _Creator2=_interopRequireDefault(_Creator);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var creator=new _Creator2.default();var options=_cli2.default.parse({generate:['g','create new File with specification','string',false],new:['n','create new project']});(0,_asyncToGenerator3.default)(/*#__PURE__*/_regenerator2.default.mark(function _callee(){return _regenerator2.default.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!options.generate){_context.next=19;break;}_context.t0=options.generate;_context.next=_context.t0==='route'?4:_context.t0==='model'?7:_context.t0==='controller'?10:_context.t0==='repository'?13:_context.t0==='resource'?16:18;break;case 4:_context.next=6;return executorForLayer();case 6:return _context.abrupt('break',19);case 7:_context.next=9;return executorForLayer();case 9:return _context.abrupt('break',19);case 10:_context.next=12;return executorForLayer();case 12:return _context.abrupt('break',19);case 13:_context.next=15;return executorForLayer();case 15:return _context.abrupt('break',19);case 16:_context.next=18;return executorForResource();case 18:return _context.abrupt('break',19);case 19:case'end':return _context.stop();}}},_callee,undefined);}))();function getLayers(){return['model','controller','route','repository'];}function templateSelectors(criteria){var templates=[{name:'default',criteria:'#default'},{name:'mongorito',criteria:'#mongorito'},{name:'sequelize',criteria:'#sequelize'}];var found=_lodash2.default.find(templates,{name:criteria});return found;}