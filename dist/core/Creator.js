'use strict';Object.defineProperty(exports,"__esModule",{value:true});var _regenerator=require('babel-runtime/regenerator');var _regenerator2=_interopRequireDefault(_regenerator);var _asyncToGenerator2=require('babel-runtime/helpers/asyncToGenerator');var _asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2);var _promise=require('babel-runtime/core-js/promise');var _promise2=_interopRequireDefault(_promise);var _classCallCheck2=require('babel-runtime/helpers/classCallCheck');var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require('babel-runtime/helpers/createClass');var _createClass3=_interopRequireDefault(_createClass2);var _fs=require('fs');var _fs2=_interopRequireDefault(_fs);var _CliMessage=require('../utils/CliMessage');var _CliMessage2=_interopRequireDefault(_CliMessage);var _Generator=require('./Generator');var _Generator2=_interopRequireDefault(_Generator);var _Reader=require('./Reader');var _Reader2=_interopRequireDefault(_Reader);var _lodash=require('lodash');var _lodash2=_interopRequireDefault(_lodash);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var Creator=function(){function Creator(){(0,_classCallCheck3.default)(this,Creator);}/**
     * 
     * @param {*} layer 
     */(0,_createClass3.default)(Creator,[{key:'generateLayer',/**
     * 
     * @param {*} fileOptions 
     */value:function generateLayer(fileOptions,templateSelector){var _this=this;return new _promise2.default(function(){var _ref=(0,_asyncToGenerator3.default)(/*#__PURE__*/_regenerator2.default.mark(function _callee(resolve,receject){var file,pathOfTemlate;return _regenerator2.default.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;file='';pathOfTemlate='';if(!_fs2.default.existsSync(fileOptions.path)){_context.next=5;break;}return _context.abrupt('return',_CliMessage2.default.warningMsg(fileOptions.path+' allready exist'));case 5:_this.createLayerFolder(fileOptions.folder);pathOfTemlate=Creator.getPathOfTemplates(fileOptions.layer);_context.next=9;return _Reader2.default.readTemplateByLines(pathOfTemlate,templateSelector);case 9:file=_context.sent;file=_this.replaceTemplate(file,fileOptions);_this.createFile(fileOptions.path,file);_CliMessage2.default.successMsg(fileOptions.path+' created');return _context.abrupt('return',resolve());case 16:_context.prev=16;_context.t0=_context['catch'](0);return _context.abrupt('return',_CliMessage2.default.errorMsg(_context.t0));case 19:case'end':return _context.stop();}}},_callee,_this,[[0,16]]);}));return function(_x,_x2){return _ref.apply(this,arguments);};}());}/**
     * 
     * @param {*} pathOfLayerFolder 
     */},{key:'createLayerFolder',value:function createLayerFolder(pathOfLayerFolder){try{if(_fs2.default.existsSync(pathOfLayerFolder))return;_fs2.default.mkdirSync(pathOfLayerFolder);}catch(error){return _CliMessage2.default.errorMsg(error);}}/**
     * 
     * @param {*} path 
     * @param {*} file 
     */},{key:'createFile',value:function createFile(path,file){try{if(_fs2.default.existsSync(path))return;_fs2.default.writeFileSync(path,file);}catch(error){return _CliMessage2.default.errorMsg(error);}}/**
     * 
     * @param {*} templatePath 
     */},{key:'readTemplate',value:function readTemplate(templatePath){try{var file=_fs2.default.readFileSync(templatePath,'utf-8');return file;}catch(error){return _CliMessage2.default.errorMsg(error);}}/**
     * 
     * @param {*} file 
     * @param {*} newName 
     */},{key:'replaceTemplate',value:function replaceTemplate(file,fileOptions){switch(fileOptions.layer){case'route':var generatorController=new _Generator2.default(fileOptions.original,'controller');file=file.replace(/(controllerName)/g,generatorController.fileName);break;case'model':break;case'controller':var generatorRepository=new _Generator2.default(fileOptions.original,'repository');file=file.replace(/(nameRepository)/g,generatorRepository.fileName);file=file.replace(/(instanceRepository)/g,_lodash2.default.lowerFirst(generatorRepository.fileName));break;case'repository':var generatorModel=new _Generator2.default(fileOptions.original,'model');file=file.replace(/(nameModel)/g,generatorModel.fileName);break;default:break;}return file.replace(/(fileName)/g,fileOptions.fileName);}}],[{key:'getPathOfTemplates',value:function getPathOfTemplates(layer){var coreTemplatesPath=__dirname+'/core-templates';var suffix='.template';var ext='.txt';switch(layer){case'route':coreTemplatesPath=coreTemplatesPath+'/'+layer+suffix+ext;break;case'model':coreTemplatesPath=coreTemplatesPath+'/'+layer+suffix+ext;break;case'controller':coreTemplatesPath=coreTemplatesPath+'/'+layer+suffix+ext;break;case'repository':coreTemplatesPath=coreTemplatesPath+'/'+layer+suffix+ext;break;default:break;}return coreTemplatesPath;}}]);return Creator;}();exports.default=Creator;